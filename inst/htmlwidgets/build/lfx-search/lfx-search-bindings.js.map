{"version":3,"file":"lfx-search-bindings.js","mappings":"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","sources":["webpack://leaflet.extras/./inst/htmlwidgets/bindings/lfx-search-bindings.js"],"sourcesContent":["/* global $, LeafletWidget, L, Shiny, HTMLWidgets, google */\r\n\r\n// helper function to conver JS event to Shiny Event\r\nfunction eventToShiny(e) {\r\n  var shinyEvent = {};\r\n  shinyEvent.latlng = {};\r\n  shinyEvent.latlng.lat = e.latlng.lat;\r\n  shinyEvent.latlng.lng = e.latlng.lng;\r\n  if(!$.isEmptyObject(e.title)) {\r\n    shinyEvent.title = e.title;\r\n  }\r\n  if(!$.isEmptyObject(e.layer)) {\r\n    shinyEvent.layer = e.layer.toGeoJSON();\r\n  }\r\n  return shinyEvent;\r\n}\r\n\r\nLeafletWidget.methods.addSearchOSM = function(options) {\r\n\r\n  (function(){\r\n    var map = this;\r\n\r\n    if(map.searchControlOSM) {\r\n      map.searchControlOSM.remove(map);\r\n      delete map.searchControlOSM;\r\n    }\r\n\r\n    options = options || {};\r\n    options.textPlaceholder = options.textPlaceholder ? options.textPlaceholder : 'Search using OSM Geocoder';\r\n    options.url = options.url ? options.url : 'https://nominatim.openstreetmap.org/search?format=json&q={s}';\r\n    options.jsonpParam = options.jsonpParam ? options.jsonpParam : 'json_callback';\r\n    options.propertyName = options.propertyName ? options.propertyName : 'display_name';\r\n    options.propertyLoc = options.propertyLoc ? options.propertyLoc : ['lat','lon'];\r\n\r\n    // https://github.com/stefanocudini/leaflet-search/issues/129\r\n    options.marker = L.circleMarker([0,0],{radius:30});\r\n\r\n    if(options.moveToLocation) {\r\n      options.moveToLocation = function(latlng, title, map) {\r\n        var zoom = options.zoom || 16;\r\n        var maxZoom = map.getMaxZoom();\r\n        if(maxZoom && zoom > maxZoom) {\r\n          zoom = maxZoom;\r\n        }\r\n        map.setView(latlng, zoom);\r\n      };\r\n    }\r\n\r\n    map.searchControlOSM = new L.Control.Search(options);\r\n    map.searchControlOSM.addTo(map);\r\n\r\n    map.searchControlOSM.on('search:locationfound', function(e){\r\n      // Shiny stuff\r\n      if (!HTMLWidgets.shinyMode) return;\r\n      Shiny.onInputChange(map.id+'_search_location_found', eventToShiny(e));\r\n    });\r\n\r\n  }).call(this);\r\n};\r\n\r\nvar clickOSMEventHandler;\r\nLeafletWidget.methods.removeSearchOSM = function() {\r\n  (function(){\r\n    var map = this;\r\n    if(map.searchControlOSM) {\r\n      map.searchControlOSM.remove(map);\r\n      delete map.searchControlOSM;\r\n    }\r\n    var revsear = document.getElementById('reverseSearchOSM');\r\n    if (revsear) {\r\n      revsear.remove();\r\n      map.off('click', clickOSMEventHandler);\r\n    }\r\n  }).call(this);\r\n};\r\n\r\nLeafletWidget.methods.addReverseSearchOSM = function(options, group) {\r\n  (function() {\r\n\r\n    var map = this;\r\n\r\n    group = group || 'reverse_search_osm' ;\r\n    map.layerManager.clearGroup(group);\r\n\r\n    var displayControl = document.getElementById('reverseSearchOSM');\r\n\r\n    var searchURL = 'https://nominatim.openstreetmap.org/reverse?format=json&polygon_geojson=1';\r\n\r\n    clickOSMEventHandler = function(e){\r\n      var latlng = e.latlng;\r\n\r\n      // This will hold the query, boundingbox, and found feature layers\r\n      var container = L.featureGroup();\r\n      var layerID = L.stamp(container);\r\n\r\n      if(options.showSearchLocation) {\r\n        var marker = L.marker(e.latlng,{'type': 'query'}).bindTooltip(\r\n          'lat='+latlng.lat+' lng='+latlng.lng+'</P>');\r\n        /* eslint-disable no-unused-vars */\r\n        var m_layerID = L.stamp(marker);\r\n        /* eslint-enable no-unused-vars */\r\n        container.addLayer(marker);\r\n      }\r\n\r\n      var query = searchURL + '&lat=' + latlng.lat + '&lon=' + latlng.lng;\r\n\r\n      $.ajax({url: query, dataType: 'json'}).done(function(result){\r\n        // Check if the response contains an error\r\n        if (result.error && result.error === 'Unable to geocode') {\r\n          displayControl.innerHTML = 'Unable to geocode';\r\n          return;\r\n        }\r\n\r\n        if(!$.isEmptyObject(displayControl)) {\r\n          var displayText = '<div>';\r\n          displayText = displayText + 'Display Name: ' +\r\n            ( (result.display_name) ?  result.display_name : '' ) + '<br/>';\r\n          displayText =  displayText + '</div>';\r\n          displayControl.innerHTML = displayText;\r\n        }\r\n\r\n        var bb = L.latLngBounds(\r\n          L.latLng(result.boundingbox[0],result.boundingbox[2]),\r\n          L.latLng(result.boundingbox[1], result.boundingbox[3]));\r\n\r\n        if(options.showBounds) {\r\n          var rect = L.rectangle(bb, {\r\n            weight:2, color: '#444444', clickable: false,\r\n            dashArray: '5,10', 'type': 'result_boundingbox'});\r\n          /* eslint-disable no-unused-vars */\r\n          var bb_layerID = L.stamp(rect);\r\n          /* eslint-enable no-unused-vars */\r\n          container.addLayer(rect);\r\n        }\r\n\r\n        if(options.showFeature) {\r\n          var feature = L.geoJson(result.geojson,\r\n            {\r\n              weight:2, color: 'red', dashArray: '5,10',\r\n              clickable : false, 'type': 'result_feature',\r\n              pointToLayer: function(feature, latlng) {\r\n                return L.circleMarker(latlng,{\r\n                  weight:2, color: 'red', dashArray: '5,10', clickable : false});\r\n              }\r\n            });\r\n\r\n          /* eslint-disable no-unused-vars */\r\n          var f_layerID = L.stamp(feature);\r\n          /* eslint-enable no-unused-vars */\r\n          container.addLayer(feature);\r\n        }\r\n\r\n        var tmp = container.getLayers();\r\n        if(!$.isEmptyObject(tmp) && tmp.length >= 0) {\r\n\r\n          if(!$.isEmptyObject(marker)) {\r\n            marker.on('mouseover', function(){\r\n              if(!$.isEmptyObject(rect)) {\r\n                rect.setStyle({fillOpacity: 0.5, opacity: 0.8, weight: 5});\r\n                rect.bringToFront();\r\n              }\r\n              if(!$.isEmptyObject(feature)) {\r\n                feature.setStyle({fillOpacity: 0.5, opacity: 0.8, weight: 5});\r\n                feature.bringToFront();\r\n              }\r\n            });\r\n            marker.on('mouseout', function(){\r\n              if(!$.isEmptyObject(rect)) {\r\n                rect.setStyle({fillOpacity: 0.2, opacity: 0.5, weight: 2});\r\n                rect.bringToBack();\r\n              }\r\n              if(!$.isEmptyObject(feature)) {\r\n                feature.setStyle({fillOpacity: 0.2, opacity: 0.5, weight: 2});\r\n                feature.bringToBack();\r\n              }\r\n            });\r\n          }\r\n\r\n          map.layerManager.addLayer(container, 'search', layerID, group);\r\n          if(options.fitBounds)\r\n            map.fitBounds(container.getBounds());\r\n        }\r\n\r\n        if (HTMLWidgets.shinyMode) {\r\n          Shiny.onInputChange(map.id+'_reverse_search_feature_found',{\r\n            'query': {'lat': latlng.lat, 'lng': latlng.lng},\r\n            'result': result\r\n          });\r\n        }\r\n\r\n      });\r\n    };\r\n\r\n    map.on('click', clickOSMEventHandler);\r\n\r\n  }).call(this);\r\n};\r\n\r\n\r\nLeafletWidget.methods.searchOSMText = function(text) {\r\n  (function(){\r\n    var map = this;\r\n    if(map.searchControlOSM) {\r\n      map.searchControlOSM.searchText(text);\r\n    }\r\n  }).call(this);\r\n};\r\n\r\n\r\n\r\n\r\nLeafletWidget.methods.addSearchGoogle = function(options) {\r\n\r\n  (function(){\r\n    var map = this;\r\n\r\n    if(map.searchControlGoogle) {\r\n      map.searchControlGoogle.remove(map);\r\n      delete map.searchControlGoogle;\r\n    }\r\n\r\n    var geocoder = new google.maps.Geocoder();\r\n\r\n    function googleGeocoding(text, callResponse) {\r\n      geocoder.geocode({address: text}, callResponse);\r\n    }\r\n\r\n    function formatJSON(rawjson) {\r\n      var json = {},\r\n        key, loc;\r\n\r\n      for(var i in rawjson) {\r\n        key = rawjson[i].formatted_address;\r\n        loc = L.latLng( rawjson[i].geometry.location.lat(), rawjson[i].geometry.location.lng() );\r\n        json[ key ]= loc; //key,value format\r\n      }\r\n      return json;\r\n    }\r\n\r\n    options = options || {};\r\n    options.markerLocation = true;\r\n    options.textPlaceholder = options.textPlaceholder ? options.textPlaceholder : 'Search using Google Geocoder';\r\n\r\n    // https://github.com/stefanocudini/leaflet-search/issues/129\r\n    options.marker = L.circleMarker([0,0],{radius:30});\r\n\r\n    if(options.moveToLocation) {\r\n      options.moveToLocation = function(latlng, title, map) {\r\n        var zoom = options.zoom || 16;\r\n        var maxZoom = map.getMaxZoom();\r\n        if(maxZoom && zoom > maxZoom) {\r\n          zoom = maxZoom;\r\n        }\r\n        map.setView(latlng, zoom);\r\n      };\r\n    }\r\n\r\n    options.sourceData = googleGeocoding;\r\n    options.formatData = formatJSON;\r\n\r\n    map.searchControlGoogle = new L.Control.Search(options);\r\n    map.searchControlGoogle.addTo(map);\r\n\r\n    map.searchControlGoogle.on('search:locationfound', function(e){\r\n      // Shiny stuff\r\n      if (!HTMLWidgets.shinyMode) return;\r\n      Shiny.onInputChange(map.id+'_search_location_found', eventToShiny(e));\r\n    });\r\n\r\n  }).call(this);\r\n};\r\n\r\nvar clickGOOEventHandler;\r\nLeafletWidget.methods.removeSearchGoogle = function() {\r\n  (function(){\r\n    var map = this;\r\n    if(map.searchControlGoogle) {\r\n      map.searchControlGoogle.remove(map);\r\n      delete map.searchControlGoogle;\r\n    }\r\n    var revsear = document.getElementById('reverseSearchGoogle');\r\n    if (revsear) {\r\n      revsear.remove();\r\n      map.off('click', clickGOOEventHandler);\r\n    }\r\n  }).call(this);\r\n};\r\n\r\nLeafletWidget.methods.addReverseSearchGoogle = function(options, group) {\r\n  (function() {\r\n\r\n    var map = this;\r\n\r\n    group = group || 'reverse_search_google' ;\r\n    map.layerManager.clearGroup(group);\r\n\r\n    var displayControl = document.getElementById('reverseSearchGoogle');\r\n\r\n    var geocoder = new google.maps.Geocoder();\r\n\r\n    clickGOOEventHandler = function(e){\r\n      var latlng = e.latlng;\r\n      // This will hold the query, boundingbox, and found feature layers\r\n      var container = L.featureGroup();\r\n      var layerID = L.stamp(container);\r\n\r\n      if(options.showSearchLocation) {\r\n        var marker = L.marker(e.latlng,{'type': 'query'}).bindTooltip(\r\n          'lat='+latlng.lat+' lng='+latlng.lng+'</P>');\r\n        /* eslint-disable no-unused-vars */\r\n        var m_layerID = L.stamp(marker);\r\n        /* eslint-enable no-unused-vars */\r\n        container.addLayer(marker);\r\n      }\r\n\r\n      geocoder.geocode(\r\n        {'location': {'lat': latlng.lat, 'lng': latlng.lng}},\r\n        function(results, status) {\r\n\r\n          if(status === 'OK') {\r\n            if(results[0]) {\r\n              var result = results[0];\r\n\r\n              if(!$.isEmptyObject(displayControl)) {\r\n                var displayText = '<div>';\r\n                displayText = displayText + 'Address: ' +\r\n                  ( (result.formatted_address) ?  result.formatted_address : '' ) + '<br/>';\r\n                displayText =  displayText + '</div>';\r\n                displayControl.innerHTML = displayText;\r\n              }\r\n\r\n              var bb = L.latLngBounds(\r\n                L.latLng(result.geometry.viewport.f.f,\r\n                  result.geometry.viewport.b.b),\r\n                L.latLng(result.geometry.viewport.f.b,\r\n                  result.geometry.viewport.b.f));\r\n\r\n              if(options.showBounds) {\r\n                var rect = L.rectangle(bb, {\r\n                  weight:2, color: '#444444', clickable: false,\r\n                  dashArray: '5,10', 'type': 'result_boundingbox'});\r\n                /* eslint-disable no-unused-vars */\r\n                var bb_layerID = L.stamp(rect);\r\n                /* eslint-enable no-unused-vars */\r\n                container.addLayer(rect);\r\n              }\r\n\r\n              if(options.showFeature) {\r\n                var feature = L.circleMarker(\r\n                  L.latLng(\r\n                    result.geometry.location.lat(),\r\n                    result.geometry.location.lng()\r\n                  ), {\r\n                    weight:2, color: 'red', dashArray: '5,10',\r\n                    clickable : false, 'type': 'result_feature'\r\n                  }\r\n                );\r\n\r\n                /* eslint-disable no-unused-vars */\r\n                var f_layerID = L.stamp(feature);\r\n                /* eslint-disable no-unused-vars */\r\n                container.addLayer(feature);\r\n              }\r\n\r\n              var tmp = container.getLayers();\r\n              if(!$.isEmptyObject(tmp) && tmp.length >= 0) {\r\n\r\n                if(!$.isEmptyObject(marker)) {\r\n                  marker.on('mouseover', function(e){\r\n                    if(!$.isEmptyObject(rect)) {\r\n                      rect.setStyle({fillOpacity: 0.5, opacity: 0.8, weight: 5});\r\n                      rect.bringToFront();\r\n                    }\r\n                    if(!$.isEmptyObject(feature)) {\r\n                      feature.setStyle({fillOpacity: 0.5, opacity: 0.8, weight: 5});\r\n                      feature.bringToFront();\r\n                    }\r\n                  });\r\n                  marker.on('mouseout', function(e){\r\n                    if(!$.isEmptyObject(rect)) {\r\n                      rect.setStyle({fillOpacity: 0.2, opacity: 0.5, weight: 2});\r\n                      rect.bringToBack();\r\n                    }\r\n                    if(!$.isEmptyObject(feature)) {\r\n                      feature.setStyle({fillOpacity: 0.2, opacity: 0.5, weight: 2});\r\n                      feature.bringToBack();\r\n                    }\r\n                  });\r\n                }\r\n\r\n                map.layerManager.addLayer(container, 'search', layerID, group);\r\n                if(options.fitBounds)\r\n                  map.fitBounds(container.getBounds());\r\n              }\r\n\r\n              if (HTMLWidgets.shinyMode) {\r\n                Shiny.onInputChange(map.id+'_reverse_search_feature_found',{\r\n                  'query': {'lat': latlng.lat, 'lng': latlng.lng},\r\n                  'result': result\r\n                });\r\n              }\r\n            } else {\r\n              if(!$.isEmptyObject(displayControl))\r\n                displayControl.innerHTML = 'No Results Found';\r\n              console.error('No Results Found');\r\n            }\r\n          } else {\r\n            if(!$.isEmptyObject(displayControl))\r\n              displayControl.innerHTML = 'Reverse Geocoding failed due to: ' + status;\r\n            console.error('Reverse Geocoing failed due to: ' + status);\r\n          }\r\n        }\r\n      );\r\n    };\r\n\r\n    map.on('click', clickGOOEventHandler);\r\n\r\n  }).call(this);\r\n};\r\n\r\n\r\nLeafletWidget.methods.addSearchUSCensusBureau = function(options) {\r\n  (function(){\r\n    var map = this;\r\n\r\n    if(map.searchControlUSCensusBureau) {\r\n      map.searchControlUSCensusBureau.remove(map);\r\n      delete map.searchControlUSCensusBureau;\r\n    }\r\n\r\n    function formatJSON(rawjson) {\r\n      var json = {}, key, loc;\r\n\r\n      for (var i in rawjson.result.addressMatches) {\r\n        key = rawjson.result.addressMatches[i].matchedAddress;\r\n        loc = L.latLng(rawjson.result.addressMatches[i].coordinates.y, rawjson.result.addressMatches[i].coordinates.x);\r\n        json[key] = loc; //key,value format\r\n      }\r\n      return json;\r\n    }\r\n\r\n    options = options || {};\r\n\r\n    options.url = options.url ? options.url : 'https://geocoding.geo.census.gov/geocoder/locations/onelineaddress?benchmark=Public_AR_Current&format=jsonp&address={s}';\r\n    options.textPlaceholder = options.textPlaceholder ? options.textPlaceholder : 'Search using US Census Bureau TEST';\r\n\r\n    options.jsonpParam = options.jsonpParam ? options.jsonpParam : 'callback';\r\n    options.formatData = formatJSON;\r\n\r\n    // https://github.com/stefanocudini/leaflet-search/issues/129\r\n    options.marker = L.circleMarker([0,0],{radius:30});\r\n\r\n    if(options.moveToLocation) {\r\n      options.moveToLocation = function(latlng, title, map) {\r\n        var zoom = options.zoom || 16;\r\n        var maxZoom = map.getMaxZoom();\r\n        if(maxZoom && zoom > maxZoom) {\r\n          zoom = maxZoom;\r\n        }\r\n        map.setView(latlng, zoom);\r\n      };\r\n    }\r\n\r\n    map.searchControlUSCensusBureau = new L.Control.Search(options);\r\n    map.searchControlUSCensusBureau.addTo(map);\r\n\r\n    map.searchControlUSCensusBureau.on('search:locationfound', function(e){\r\n      // Shiny stuff\r\n      if (!HTMLWidgets.shinyMode) return;\r\n      Shiny.onInputChange(map.id+'_search_location_found', eventToShiny(e));\r\n    });\r\n\r\n  }).call(this);\r\n};\r\n\r\nLeafletWidget.methods.removeSearchUSCensusBureau = function() {\r\n  (function(){\r\n    var map = this;\r\n    if (map.searchControlUSCensusBureau) {\r\n      map.searchControlUSCensusBureau.remove(map);\r\n      delete map.searchControlUSCensusBureau;\r\n    }\r\n  }).call(this);\r\n};\r\n\r\n\r\nLeafletWidget.methods.addSearchFeatures = function(targetGroups, options){\r\n  (function(){\r\n    var map = this;\r\n\r\n    if(map.searchControl) {\r\n      map.searchControl.remove(map);\r\n      delete map.searchControl;\r\n    }\r\n\r\n    options = options || {};\r\n\r\n    if(options.moveToLocation) {\r\n      options.moveToLocation = function(latlng, title, map) {\r\n        var zoom = options.zoom || 16;\r\n        var maxZoom = map.getMaxZoom();\r\n        if(maxZoom && zoom > maxZoom) {\r\n          zoom = maxZoom;\r\n        }\r\n        map.setView(latlng, zoom);\r\n      };\r\n    }\r\n\r\n    // FeatureGroup that will be searched\r\n    var searchFeatureGroup;\r\n\r\n    // if we have just one group to search use it.\r\n    if(!L.Util.isArray(targetGroups)) {\r\n      var target = map.layerManager.getLayerGroup(targetGroups, false);\r\n      if(target) {\r\n        searchFeatureGroup = target;\r\n        map._searchFeatureGroupName = targetGroups;\r\n      } else {\r\n        // throw an error if we can't find the target FeatureGroup layer\r\n        throw 'Group with ID \"'+targetGroups+'\" not found';\r\n      }\r\n    } else { // if we have more than one groups to search create a new seach group with them.\r\n\r\n      searchFeatureGroup = map.layerManager.getLayerGroup('search', true);\r\n      map._searchFeatureGroupName = 'search';\r\n\r\n      $.each(targetGroups, function(k, v) {\r\n        var target = map.layerManager.getLayerGroup(v, false);\r\n        // may be remove target from map before adding to searchFeatureGroup\r\n        if(target) {\r\n          searchFeatureGroup.addLayer(target);\r\n        } else {\r\n          console.warn('Group with ID \"' + v + '\" not Found, skipping');\r\n        }\r\n      });\r\n    }\r\n\r\n    L.stamp(searchFeatureGroup);\r\n    options.layer = searchFeatureGroup;\r\n    map.searchControl = new L.Control.Search(options);\r\n    map.searchControl.addTo(map);\r\n\r\n    map.searchControl.on('search:locationfound', function(e){\r\n      if(options.openPopup && e.layer._popup) {\r\n        e.layer.openPopup();\r\n      }\r\n      // Shiny stuff\r\n      if (!HTMLWidgets.shinyMode) return;\r\n      Shiny.onInputChange(map.id+'_search_location_found', eventToShiny(e));\r\n    });\r\n\r\n  }).call(this);\r\n};\r\n\r\nLeafletWidget.methods.removeSearchFeatures = function(clearFeatures) {\r\n  (function(){\r\n    var map = this;\r\n    if (map.searchControl) {\r\n      map.searchControl.remove(map);\r\n      delete map.searchControl;\r\n    }\r\n    if (clearFeatures && map._searchFeatureGroupName) {\r\n      map.layerManager.clearGroup(map._searchFeatureGroupName);\r\n      delete map._searchFeatureGroupName ;\r\n    }\r\n  }).call(this);\r\n};\r\n"],"names":["eventToShiny","e","shinyEvent","latlng","lat","lng","$","isEmptyObject","title","layer","toGeoJSON","clickOSMEventHandler","clickGOOEventHandler","LeafletWidget","methods","addSearchOSM","options","map","this","searchControlOSM","remove","textPlaceholder","url","jsonpParam","propertyName","propertyLoc","marker","L","circleMarker","radius","moveToLocation","zoom","maxZoom","getMaxZoom","setView","Control","Search","addTo","on","HTMLWidgets","shinyMode","Shiny","onInputChange","id","call","removeSearchOSM","revsear","document","getElementById","off","addReverseSearchOSM","group","layerManager","clearGroup","displayControl","container","featureGroup","layerID","stamp","showSearchLocation","bindTooltip","addLayer","query","searchURL","ajax","dataType","done","result","error","innerHTML","displayText","display_name","bb","latLngBounds","latLng","boundingbox","showBounds","rect","rectangle","weight","color","clickable","dashArray","showFeature","feature","geoJson","geojson","pointToLayer","tmp","getLayers","length","setStyle","fillOpacity","opacity","bringToFront","bringToBack","fitBounds","getBounds","searchOSMText","text","searchText","addSearchGoogle","searchControlGoogle","geocoder","google","maps","Geocoder","markerLocation","sourceData","callResponse","geocode","address","formatData","rawjson","key","loc","json","i","formatted_address","geometry","location","removeSearchGoogle","addReverseSearchGoogle","results","status","viewport","f","b","console","addSearchUSCensusBureau","searchControlUSCensusBureau","addressMatches","matchedAddress","coordinates","y","x","removeSearchUSCensusBureau","addSearchFeatures","targetGroups","searchFeatureGroup","searchControl","Util","isArray","getLayerGroup","_searchFeatureGroupName","each","k","v","target","warn","openPopup","_popup","removeSearchFeatures","clearFeatures"],"sourceRoot":""}